+++
title = '我的新文章2'
date = 2025-11-10T21:16:55+08:00
draft = false
summary = "summary"
toc = true

+++



## 问题：

```bash
echo '{"cmd":"upload","videoId":"1k5hLBdQU5E","localPath":"C:\Users\IGR\Desktop\yt-baidu-sync\yt-baidu-sync-helper\tmp\BTC仍下跌！一路向下不回頭？反彈是否有可能？ [1k5hLBdQU5E].mp4"}' | python encodetest.py

echo 你好 | python encodetest.py

echo abc | python encodetest.py
```

```python
import sys  
print(sys.stdin.read().encode("utf8"))
```


## 出现乱码的原因
- 如果数据需要**离开 PowerShell 环境**（到外部程序、文件、网络），会使用到 `$OutputEncoding`
    
- 如果数据在 **PowerShell 内部处理**，直接使用 .NET 对象，不涉及编码
    

这就是为什么管道到 Python 时会出现乱码，而直接显示却正常的原因！


查看终端编码（控制台编码）：
Write-Host "控制台输出编码: $([System.Console]::OutputEncoding.EncodingName)"
Write-Host "控制台输入编码: $([System.Console]::InputEncoding.EncodingName)"
Write-Host "当前代码页: $(chcp)"

修改（临时）终端编码：
chcp 65001    # 设置为 UTF-8

## 查看 PowerShell 编码
# 查看 PowerShell 输出编码（影响管道传输）
Write-Host "=== PowerShell 输出编码 ==="
Write-Host "输出编码: $($OutputEncoding.EncodingName)"
Write-Host "代码页: $($OutputEncoding.CodePage)"
Write-Host "WebName: $($OutputEncoding.WebName)"

修改（临时）powershell编码：
# 设置为 UTF-8（推荐）
$OutputEncoding = [System.Text.Encoding]::UTF8

# 设置为 GBK
$OutputEncoding = [System.Text.Encoding]::GetEncoding(936)

# 设置为 ASCII
$OutputEncoding = [System.Text.Encoding]::ASCII



### 查看控制台编码（直接影响显示）
# 查看控制台输入输出编码（影响直接显示）
Write-Host "`n=== 控制台编码 ==="


##  查看 Python 编码
# 快速查看 Python 编码设置
python -c "import sys; print('Python 默认编码:', sys.getdefaultencoding())"
python -c "import sys; print('标准输入编码:', sys.stdin.encoding)"
python -c "import sys; print('标准输出编码:', sys.stdout.encoding)"


```bash

python -c "import locale; print('区域设置编码:', locale.getpreferredencoding())"

区域设置编码: cp936



```
